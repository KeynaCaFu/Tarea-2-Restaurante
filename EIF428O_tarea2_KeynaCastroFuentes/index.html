<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <link rel="stylesheet" href="css/bootstrap.min.css">
    <title>Sistema de Comandas - Restaurante</title>
    <style>
       
        .table thead th {
            background-color: #486094;
            color: #fff;
            border-bottom: none;
        }
        .table th, .table td {
            vertical-align: middle; 
        }
        .table td {
            padding: 8px; 
        }
        .table-actions {
            width: 10%; 
        }
        .btn-finalize {
            padding: 6px 12px; 
            font-size: 14px; 
            background-color: #6aa728;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .btn-finalize:hover {
            background-color: #5ba36b; 
        }
    </style>
</head>
<body>

    <div class="container mt-4">
   <ul class="nav nav-pills nav-fill gap-2 p-1 small bg-primary rounded-5 shadow-sm" id="pillNav2" role="tablist" style="--bs-nav-link-color: var(--bs-white); --bs-nav-pills-link-active-color: var(--bs-primary); --bs-nav-pills-link-active-bg: var(--bs-white); background-color: #1E2A44 !important;"
    <li class="nav-item" role="presentation">
        <button class="nav-link active rounded-5" id="home-tab2" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Inicio</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link rounded-5" id="profile-tab2" data-bs-toggle="tab" data-bs-target="#comandas" type="button" role="tab" aria-controls="comandas" aria-selected="false">Gestionar Comandas</button>
    </li>
    <!-- <li class="nav-item" role="presentation">
        <button class="nav-link rounded-5" id="contact-tab2" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">Contacto</button>
    </li> -->
</ul>

<div class="tab-content mt-4">
    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab2">
        <h1 class="text-center mb-4">Bienvenido al Sistema de Comandas del Restaurante</h1>
        <p class="text-center">Gestiona tus comandas de manera eficiente y sencilla.</p>
        <div class="text-center">
            <img src="img/logo2.jpg" alt="Restaurante" class="img-fluid rounded" style="max-width: 500px;">
        </div>
    </div>


    <div class="tab-pane fade" id="comandas" role="tabpanel" aria-labelledby="profile-tab2">
        <div class="row">
            <div class="col-md-6">
                <form id="orderForm">
                    <div class="mb-3">
                        <label for="menuSelect" class="form-label">Selecciona un plato:</label>
                        <select class="form-select" id="menuSelect">
                            <option value="">-- Seleccione un ítem --</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="quantity" class="form-label">Cantidad:</label>
                        <input type="number" class="form-control" id="quantity" min="1" value="1">  
                    </div>
                    <button type="button" class="btn btn-primary" style="background-color: #54575c;" id="addButton">Agregar a la comanda</button>  
                </form>
            </div>
        </div>    

        <div class="row mt-4">
            <div class="col-12">
                <table class="table table-striped" id="ordersTable">
                    <thead>
                        <tr>
                            <th>Comanda</th>
                            <th>Cantidad</th>
                            <th>Precio</th>
                            <th>Subtotal</th>
                           <th class="table-actions">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="ordersBody">

                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3" class="text-end fw-bold">Total:</td>
                            <td id="totalGeneral" class="fw-bold">₡0</td>
                            <td></td>
                        </tr>
                    </tfoot> 
                </table>
            </div>
        </div>
        <!-- </div> -->

        <div class="row mt-3">
            <div class="col-12 text-end">
                <button type="button" class="btn-finalize btn-success" id="finalizeButton">Finalizar Comanda</button>
            </div>
        </div>
    </div>
    </div>
</div>


<script src="js/jquery-3.7.1.min.js"></script>
<script src="js/jquery-ui.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
        // Menú JSON cargado como array
        const menu = [
            {"id":1,"nombre":"Hamburguesa Clásica","tipo":"Platillo","precio":3500},
            {"id":2,"nombre":"Pizza Margarita","tipo":"Platillo","precio":5000},
            {"id":3,"nombre":"Casado con Pollo","tipo":"Platillo","precio":4000},
            {"id":4,"nombre":"Ensalada César","tipo":"Platillo","precio":2800},
            {"id":5,"nombre":"Sopa de Mariscos","tipo":"Platillo","precio":4500},
            {"id":6,"nombre":"Taco de Carne","tipo":"Platillo","precio":1500},
            {"id":7,"nombre":"Filete de Res","tipo":"Platillo","precio":6000},
            {"id":8,"nombre":"Ceviche Mixto","tipo":"Platillo","precio":3700},
            {"id":9,"nombre":"Papas Fritas","tipo":"Platillo","precio":1200},
            {"id":10,"nombre":"Nachos con Queso","tipo":"Platillo","precio":2500},
            {"id":11,"nombre":"Helado Vainilla","tipo":"Platillo","precio":1200},
            {"id":12,"nombre":"Pollo Frito","tipo":"Platillo","precio":3200},
            {"id":13,"nombre":"Limonada con Hierbabuena","tipo":"Bebida","precio":1400},
            {"id":14,"nombre":"Jugo de Sandía","tipo":"Bebida","precio":1100},
            {"id":15,"nombre":"Batido de Banano","tipo":"Bebida","precio":1300},
            {"id":16,"nombre":"Agua Mineral","tipo":"Bebida","precio":700},
            {"id":17,"nombre":"Té Frío","tipo":"Bebida","precio":1000},
            {"id":18,"nombre":"Refresco Natural Naranja","tipo":"Bebida","precio":1200},
            {"id":19,"nombre":"Cerveza Artesanal","tipo":"Bebida","precio":2200},
            {"id":20,"nombre":"Café Negro","tipo":"Bebida","precio":800}
        ];
        let orders = [];
        let orderIdCounter = 1;

        //funcion para llenar el select con los platos del menu
        function populateMenuSelect(){
            const select = $('#menuSelect');
            select.empty();
            select.append('<option value="">-- Seleccione un ítem --</option>');
            $.each(menu,function(index,item){
               const optionText = `${item.tipo} - ₡${item.nombre} - ₡${item.precio}`;
                select.append(`<option value='${JSON.stringify(item)}'>${optionText}</option>`);
            });
        }

        //funcion para actualizar la tabla de pedidos
        function updateOrdersTable(){
            const tbody = $('#ordersBody');
            tbody.empty();
            let total = 0;

            $.each(orders,function(index,order){
                const subtotal = order.precio * order.cantidad;
                total += subtotal;
                const row = `
                <tr>
                    <td>${order.nombre}</td>
                    <td>${order.cantidad}</td>
                    <td>${order.precio}</td>
                    <td>${subtotal}</td>
                    <td><button class ="btn btn-danger btn-sm deleteOrder" data-index="${index}" >Eliminar</button></td>
                    </tr>`;

                    tbody.append(row);
                });

                $('#totalGeneral').text(`₡${total}`);
        }
        //evento para agregar una comanda
        $('#addButton').click(function(){
            const selectedValue = $('#menuSelect').val();
            const quantity = parseInt($('#quantity').val()) || 1;

            if(!selectedValue){
                alert('Por favor, selecione un elemento del menú.');
                return;
            }
            if(quantity < 1){
                alert('La cantidad debe ser al menos 1.');
                return;
            }

            const menuItem = JSON.parse(selectedValue);
            const newOrder = {
                id: orderIdCounter++,
                nombre: menuItem.nombre,
                precio: menuItem.precio,
                cantidad: quantity,
                subtotal: menuItem.precio * quantity
            };
            
            orders.push(newOrder);
            updateOrdersTable();

            //limpiar el formulario
            $('#menuSelect').val("");
            $('#quantity').val(1);
        });

        //evento para eliminar una comanda
        $('#ordersTable').on('click', '.deleteOrder', function() {
            const index = $(this).data('index');
            orders.splice(index, 1);
            updateOrdersTable();   
        });
        //evento para finalizar la comanda
        $('#finalizeButton').click(function(){
            console.log(JSON.stringify(orders));
            alert('Comanda finalizada. Revisa la consola para el Json detalles.');
        });
        //para inicializar el select al cargar la pagina
        $(document).ready(function(){
            populateMenuSelect();
        });                    
</script>

</body>
</html>